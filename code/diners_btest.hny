from diners import Diners, enter, exit

const N = 4

forks = Diners(N)

def diner(which):
    let left, right = (which, (which + 1) % N):
        while choose({ False, True }):
            enter(?forks, which)
            print(which, "start")
            print(which, "stop")
            exit(?forks, which)

for i in {0..N-1}:
    spawn diner(i)
